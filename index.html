<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sahu Paints House ‚Äì Color Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet" />

  <style>
    :root {
      --primary: #c62828;
      --primary-soft: #ffe5e5;
      --bg: #f5f6fa;
      --card-bg: #ffffff;
      --border-soft: #e0e0e0;
      --text-main: #222222;
      --text-muted: #777777;
      --shadow-soft: 0 8px 20px rgba(0,0,0,0.06);
      --radius-card: 14px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top left, #ffffff, #f1f3f8);
      color: var(--text-main);
      min-height: 100vh;
    }

    /* HEADER */
    .app-header {
      position: sticky;
      top: 0;
      z-index: 20;
      background: linear-gradient(135deg, #ffffff 0%, #ffe5e5 100%);
      box-shadow: 0 2px 10px rgba(0,0,0,0.06);
    }

    .header-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .brand-block {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .105
      {
      width: 42px;
      height: 42px;
      border-radius: 12px;
      background: radial-gradient(circle at 30% 20%, #ffffff, #c62828);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ffffff;
      font-weight: 700;
      font-size: 20px;
      box-shadow: 0 6px 16px rgba(198,40,40,0.45);
    }

    .brand-text-main {
      font-weight: 600;
      font-size: 18px;
    }

    .brand-text-sub {
      font-size: 12px;
      color: var(--text-muted);
    }

    .header-contact {
      text-align: right;
      font-size: 12px;
      color: var(--text-muted);
    }

    .header-contact strong {
      display: block;
      color: var(--primary);
      font-size: 14px;
    }

    /* LAYOUT */
    .app-shell {
      max-width: 1100px;
      margin: 16px auto 32px;
      padding: 0 16px 16px;
      display: grid;
      grid-template-columns: 240px minmax(0, 1fr);
      gap: 16px;
    }

    @media (max-width: 800px) {
      .app-shell {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    /* SIDEBAR NAV */
    .sidebar {
      background: rgba(255,255,255,0.9);
      border-radius: 16px;
      box-shadow: var(--shadow-soft);
      padding: 12px;
      backdrop-filter: blur(8px);
    }

    .sidebar-title {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 8px;
      padding: 0 8px;
    }

    .nav-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .nav-item {
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      color: var(--text-muted);
      transition: background 0.16s ease, color 0.16s ease, transform 0.08s ease;
    }

    .nav-item span.icon {
      width: 18px;
      text-align: center;
      opacity: 0.7;
    }

    .nav-item.active {
      background: var(--primary);
      color: #ffffff;
      box-shadow: 0 6px 14px rgba(198,40,40,0.5);
      transform: translateY(-1px);
    }

    .nav-item:not(.active):hover {
      background: #f7f7f8;
      color: var(--text-main);
    }

    /* MAIN AREA */
    .main-panel {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .section-card {
      background: #ffffff;
      border-radius: 18px;
      box-shadow: var(--shadow-soft);
      padding: 16px 16px 18px;
      border: 1px solid rgba(255,255,255,0.8);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .section-title {
      font-size: 16px;
      font-weight: 600;
    }

    .section-subtitle {
      font-size: 12px;
      color: var(--text-muted);
    }

    /* FILTER + SEARCH */
    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
      align-items: center;
    }

    .chip {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      font-size: 11px;
      background: #fafafa;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.16s ease;
    }

    .chip.active {
      background: var(--primary-soft);
      border-color: var(--primary);
      color: var(--primary);
    }

    .search-input {
      flex: 1 1 140px;
      min-width: 120px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      padding: 7px 12px;
      font-size: 12px;
      outline: none;
      background: #fafafa;
    }

    .search-input:focus {
      border-color: var(--primary);
      background: #ffffff;
    }

    /* COLOR CARDS GRID */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
    }

    .color-card {
      background: var(--card-bg);
      border-radius: var(--radius-card);
      overflow: hidden;
      box-shadow: 0 8px 16px rgba(0,0,0,0.05);
      border: 1px solid rgba(0,0,0,0.03);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      transition: transform 0.14s ease, box-shadow 0.14s ease;
    }

    .color-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 22px rgba(0,0,0,0.08);
    }

    .color-swatch {
      height: 90px;
      border-bottom: 1px solid rgba(255,255,255,0.5);
    }

    .color-card-body {
      padding: 8px 10px 10px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .color-name {
      font-size: 13px;
      font-weight: 500;
    }

    .color-meta-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--text-muted);
    }

    .tag-pill {
      font-size: 10px;
      padding: 3px 6px;
      border-radius: 999px;
      background: #f1f1f1;
    }

    .code-pill {
      font-size: 10px;
      padding: 3px 6px;
      border-radius: 999px;
      background: #f9f9f9;
      border: 1px dashed #ddd;
    }

    .card-actions {
      margin-top: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .btn-ghost {
      border: none;
      background: transparent;
      font-size: 11px;
      color: var(--primary);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 0;
    }

    .btn-ghost.small {
      font-size: 10px;
      color: var(--text-muted);
    }

    /* FORMS */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 14px;
      margin-top: 6px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
    }

    .form-group label {
      color: var(--text-muted);
      font-size: 11px;
    }

    .form-control, .form-select {
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      padding: 7px 10px;
      font-size: 12px;
      outline: none;
      background: #fafafa;
    }

    .form-control:focus, .form-select:focus {
      border-color: var(--primary);
      background: #ffffff;
    }

    .form-row-inline {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .color-preview-box {
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      width: 110px;
      height: 52px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: #ffffff;
      font-weight: 500;
    }

    .btn-primary {
      border: none;
      border-radius: 999px;
      background: var(--primary);
      color: #ffffff;
      padding: 8px 18px;
      font-size: 12px;
      cursor: pointer;
      box-shadow: 0 8px 16px rgba(198,40,40,0.55);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(198,40,40,0.65);
    }

    /* IMAGE GALLERY */
    .image-card {
      background: var(--card-bg);
      border-radius: var(--radius-card);
      overflow: hidden;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(0,0,0,0.03);
      display: flex;
      flex-direction: column;
    }

    .image-wrapper {
      position: relative;
      width: 100%;
      padding-top: 70%;
      overflow: hidden;
    }

    .image-wrapper img {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .image-card-body {
      padding: 8px 10px 10px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 11px;
    }

    /* MODAL */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.35);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 30;
      padding: 16px;
    }

    .modal {
      background: #ffffff;
      border-radius: 18px;
      max-width: 420px;
      width: 100%;
      box-shadow: 0 16px 40px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    .modal-header {
      padding: 12px 16px;
      border-bottom: 1px solid #f0f0f0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .modal-title {
      font-size: 14px;
      font-weight: 600;
    }

    .modal-close {
      border: none;
      background: transparent;
      font-size: 18px;
      cursor: pointer;
      color: var(--text-muted);
    }

    .modal-body {
      padding: 14px 16px 16px;
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .modal-color-swatch {
      height: 70px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.1);
    }

    /* FOOTER */
    .app-footer {
      max-width: 1100px;
      margin: 0 auto 18px;
      padding: 0 16px;
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .app-footer strong { color: var(--text-main); }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header class="app-header">
    <div class="header-inner">
      <div class="brand-block">
        <div class="177
<img src="https://integrated-magenta-3wbhcubrne-hawhbdvgyt.edgeone.dev/ChatGPT%20Image%20Apr%205,%202025,%2007_30_14%20PM.png" alt="Sahu Paints Logo" style="height: 55px; width: auto; margin-right: 10px;"/>
           <div>
          <div class="brand-text-main">Sahu Paints House</div>
          <div class="brand-text-sub">Digital Color & Shade Studio</div>
        </div>
      </div>
      <div class="header-contact">
        <span>For colour consultation & bookings</span>
        <strong>Call / WhatsApp: 7007104389</strong>
        <span>Gonda, Uttar Pradesh</span>
      </div>
    </div>
  </header>

  <main class="app-shell">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar-title">Studio navigation</div>
      <ul class="nav-list">
        <li class="nav-item active" data-target="colors-view">
          <span class="icon">üé®</span> Color gallery
        </li>
                                <li class="nav-item" data-target="palette-view">
                            <span class="icon">üé®</span> <a href="colors.html" style="color: inherit; text-decoration: none;">Color Palettes</a>
                        </li>
        <li class="nav-item" data-target="colors-add">
          <span class="icon">‚ûï</span> Add new color
        </li>
        <li class="nav-item" data-target="images-view">
          <span class="icon">üñºÔ∏è</span> Shop gallery
        </li>
        <li class="nav-item" data-target="images-add">
          <span class="icon">üì§</span> Add shop image
        </li>
      </ul>
    </aside>

    <!-- MAIN PANEL -->
    <section class="main-panel">
      <!-- COLOR GALLERY -->
      <section class="section-card" id="colors-view" data-section>
        <div class="section-header">
          <div>
            <div class="section-title">Color gallery</div>
            <div class="section-subtitle">Show customers live shades and codes</div>
          </div>
        </div>

        <div class="filter-row">
          <div class="chip active" data-filter="all">All</div>
          <div class="chip" data-filter="interior">Interior</div>
          <div class="chip" data-filter="exterior">Exterior</div>
          <div class="chip" data-filter="ceiling">Ceiling</div>
          <div class="chip" data-filter="kids">Kids room</div>
          <input type="text" id="searchColors" class="search-input" placeholder="Search by name or code..." />
        </div>

        <div id="colorsGrid" class="grid"></div>
        <div id="colorsEmptyMsg" class="section-subtitle" style="margin-top:8px; display:none;">
          No colors saved yet. Add your first shade from ‚ÄúAdd new color‚Äù.
        </div>
      </section>

      <!-- ADD COLOR -->
      <section class="section-card" id="colors-add" data-section style="display:none;">
        <div class="section-header">
          <div>
            <div class="section-title">Add new color</div>
            <div class="section-subtitle">Save any company shade with your own naming</div>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label for="colorName">Color name</label>
            <input id="colorName" class="form-control" placeholder="Eg. Royal Ivory, Cool Blue" />
          </div>
          <div class="form-group">
            <label for="colorCode">Shade code (optional)</label>
            <input id="colorCode" class="form-control" placeholder="Eg. AP-101, Custom-01" />
          </div>
          <div class="form-group">
            <label for="colorSegment">Usage segment</label>
            <select id="colorSegment" class="form-select">
              <option value="interior">Interior</option>
              <option value="exterior">Exterior</option>
              <option value="ceiling">Ceiling</option>
              <option value="kids">Kids room</option>
              <option value="other">Other / Special</option>
            </select>
          </div>
          <div class="form-group">
            <label for="colorHex">Pick shade</label>
            <input id="colorHex" type="color" class="form-control" value="#c62828" />
          </div>
          <div class="form-group" style="grid-column:1/-1;">
            <label for="colorDesc">Notes for this shade</label>
            <textarea id="colorDesc" class="form-control" rows="3" placeholder="Eg. Best for living room; matches with white / off-white"></textarea>
          </div>
        </div>

        <div class="form-row-inline">
          <div id="colorPreviewBox" class="color-preview-box" style="background:#c62828;">
            <span id="colorPreviewText">#c62828</span>
          </div>
          <button id="btnSaveColor" class="btn-primary">
            <span>Save color</span> <span>üíæ</span>
          </button>
        </div>
      </section>

      <!-- SHOP GALLERY -->
      <section class="section-card" id="images-view" data-section style="display:none;">
        <div class="section-header">
          <div>
            <div class="section-title">Shop & project gallery</div>
            <div class="section-subtitle">Show your shop and completed sites</div>
          </div>
        </div>

        <div id="imagesGrid" class="grid"></div>
        <div id="imagesEmptyMsg" class="section-subtitle" style="margin-top:8px; display:none;">
          No images added yet. Upload your shop photos from ‚ÄúAdd shop image‚Äù.
        </div>
      </section>

      <!-- ADD IMAGE -->
      <section class="section-card" id="images-add" data-section style="display:none;">
        <div class="section-header">
          <div>
            <div class="section-title">Add shop / site image</div>
            <div class="section-subtitle">Upload storefront, interior or project photos</div>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label for="imageTitle">Title</label>
            <input id="imageTitle" class="form-control" placeholder="Eg. Front view, 2BHK exterior" />
          </div>
                          <div class="form-group"><label for="imageSegment">Image Category</label><select id="imageSegment" class="form-select"><option value="interior">üè† Interior</option><option value="exterior">üå≥ Exterior</option><option value="ceiling">‚ú® Ceiling</option><option value="kids">üé® Kids Room</option><option value="other">üìå Other</option></select></div>
          <div class="form-group">
            <label for="imageArea">Area / Location (optional)</label>
            <input id="imageArea" class="form-control" placeholder="Eg. Gonda, living room, exterior front" />
          </div>
          <div class="form-group" style="grid-column:1/-1;">
            <label for="imageDesc">Description</label>
            <textarea id="imageDesc" class="form-control" rows="3" placeholder="Eg. Apex Ultima exterior, light grey with white borders"></textarea>
          </div>
          <div class="form-group">
            <label for="imageFile">Select image</label>
            <input id="imageFile" type="file" accept="image/*" class="form-control" />
          </div>
                              <div class="form-group" style="grid-column: 1/-1;">
                      <label for="imageShadesContainer">Shades used in this image (optional)</label>
                      <div id="imageShadesContainer" style="display: flex; flex-direction: column; gap: 8px;"></div>
                      <button type="button" id="btnAddShade" class="btn-ghost" style="margin-top: 8px; color: var(--primary);">+ Add shade</button>
                    </div>
        </div>

        <div class="form-row-inline">
          <div id="imagePreviewBox" class="color-preview-box" style="background:#f1f1f1; color:#444;">
            No image selected
          </div>
          <button id="btnSaveImage" class="btn-primary">
            <span>Save image</span> <span>üì§</span>
          </button>
        </div>
      </section>
    </section>
  </main>

  <!-- MODAL -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle"></div>
        <button class="modal-close" id="modalCloseBtn">&times;</button>
      </div>
      <div class="modal-body">
        <div id="modalColorSwatch" class="modal-color-swatch"></div>
        <div style="font-size:11px;">
          <strong>Segment:</strong> <span id="modalSegment"></span><br />
          <strong>Shade code:</strong> <span id="modalCode"></span>
        </div>
        <div>
          <strong>Notes:</strong>
          <div id="modalDesc" style="margin-top:4px; white-space:pre-wrap;"></div>
        </div>
        <div class="card-actions">
          <button id="modalCopyBtn" class="btn-ghost">Copy shade code</button>
          <button id="modalDeleteBtn" class="btn-ghost small">Delete color</button>
        </div>
      </div>
    </div>
  </div>

  <footer class="app-footer">
    <div>
      <strong>Sahu Paints House</strong> ¬∑ Near you in Gonda ¬∑ Professional colour guidance for your home.
    </div>
    <div>
      All digital shades are indicative only. Please confirm with physical shade card before final order.
    </div>
  </footer>

  <script>
    // ===== DATA KEYS =====
    const COLORS_KEY = "sahu_paints_colors_v1";
    const IMAGES_KEY = "sahu_paints_images_v1";

    1038
      ;
    let images = [];
    let activeFilter = "all";
    let searchTerm = "";

    let selectedColorIndex = null; // for modal
    let imageDataTemp = null;

    // ===== HELPERS: STORAGE =====
    function loadData() {
      try {
        colors = JSON.parse(localStorage.getItem(COLORS_KEY) || "[]");
        images = JSON.parse(localStorage.getItem(IMAGES_KEY) || "[]");
      } catch (e) {
        colors = [];
        images = [];
      }
    }

    function saveColors() {
      localStorage.setItem(COLORS_KEY, JSON.stringify(colors));
    }

    function saveImages() {
      localStorage.setItem(IMAGES_KEY, JSON.stringify(images));
    }

    // ===== RENDER COLORS =====
    function renderColors() {
      const grid = document.getElementById("colorsGrid");
      const emptyMsg = document.getElementById("colorsEmptyMsg");
      grid.innerHTML = "";

      let filtered = colors.filter(c => {
        const matchesFilter = activeFilter === "all" || c.segment === activeFilter;
        const term = searchTerm.trim().toLowerCase();
        const matchesSearch =
          !term ||
          (c.name && c.name.toLowerCase().includes(term)) ||
          (c.code && c.code.toLowerCase().includes(term));
        return matchesFilter && matchesSearch;
      });

      if (!filtered.length) {
        emptyMsg.style.display = "block";
        return;
      } else {
        emptyMsg.style.display = "none";
      }

      filtered.forEach((c, index) => {
        const card = document.createElement("article");
        card.className = "color-card";
        card.dataset.index = colors.indexOf(c);

        const swatch = document.createElement("div");
        swatch.className = "color-swatch";
        swatch.style.background = c.hex || "#cccccc";

        const body = document.createElement("div");
        body.className = "color-card-body";

        const name = document.createElement("div");
        name.className = "color-name";
        name.textContent = c.name || "Unnamed shade";

        const meta = document.createElement("div");
        meta.className = "color-meta-row";

        const tag = document.createElement("span");
        tag.className = "tag-pill";
        tag.textContent =
          c.segment === "interior" ? "Interior" :
          c.segment === "exterior" ? "Exterior" :
          c.segment === "ceiling" ? "Ceiling" :
          c.segment === "kids" ? "Kids room" :
          "Other";

        const code = document.createElement("span");
        code.className = "code-pill";
        code.textContent = c.code || c.hex;

        meta.appendChild(tag);
        meta.appendChild(code);

        const actions = document.createElement("div");
        actions.className = "card-actions";

        const btnCopy = document.createElement("button");
        btnCopy.className = "btn-ghost small";
        btnCopy.textContent = "Copy code";
        btnCopy.addEventListener("click", (e) => {
          e.stopPropagation();
          copyToClipboard(c.code || c.hex);
        });

        const btnDelete = document.createElement("button");
        btnDelete.className = "btn-ghost small";
        btnDelete.textContent = "Delete";
        btnDelete.addEventListener("click", (e) => {
          e.stopPropagation();
          deleteColor(colors.indexOf(c));
        });

        actions.appendChild(btnCopy);
        actions.appendChild(btnDelete);

        body.appendChild(name);
        body.appendChild(meta);
        body.appendChild(actions);

        card.appendChild(swatch);
        card.appendChild(body);

        card.addEventListener("click", () => openColorModal(colors.indexOf(c)));

        grid.appendChild(card);
      });
    }

    // ===== RENDER IMAGES =====
    function renderImages() {
      const grid = document.getElementById("imagesGrid");
      const emptyMsg = document.getElementById("imagesEmptyMsg");
      grid.innerHTML = "";

      if (!images.length) {
        emptyMsg.style.display = "block";
        return;
      } else {
        emptyMsg.style.display = "none";
      }

      images.forEach((img, index) => {
        const card = document.createElement("article");
        card.className = "image-card";

        const wrap = document.createElement("div");
        wrap.className = "image-wrapper";

        const imageEl = document.createElement("img");
        imageEl.src = img.data;
        imageEl.alt = img.title || "Shop image";

        wrap.appendChild(imageEl);

        const body = document.createElement("div");
        body.className = "image-card-body";

        const title = document.createElement("div");
        title.style.fontWeight = "500";
        title.textContent = img.title || "Untitled image";

        const desc = document.createElement("div");
        desc.style.color = "var(--text-muted)";
        desc.textContent = img.desc || "";

        const loc = document.createElement("div");
        loc.style.color = "var(--text-muted)";
        loc.style.fontSize = "10px";
        loc.textContent = img.area || "";

        const actions = document.createElement("div");
        actions.className = "card-actions";
        const btnDelete = document.createElement("button");
        btnDelete.className = "btn-ghost small";
        btnDelete.textContent = "Delete";
        btnDelete.addEventListener("click", () => deleteImage(index));
        actions.appendChild(btnDelete);

        body.appendChild(title);
        body.appendChild(desc);
        if (img.area) body.appendChild(loc);
        body.appendChild(actions);

        card.appendChild(wrap);
        card.appendChild(body);

        grid.appendChild(card);
      });
    }

    // ===== COPY TO CLIPBOARD =====
    function copyToClipboard(text) {
      if (!text) return;
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(() => {
          alert("Copied: " + text);
        }).catch(() => {
          fallbackCopy(text);
        });
      } else {
        fallbackCopy(text);
      }
    }

    function fallbackCopy(text) {
      const temp = document.createElement("textarea");
      temp.value = text;
      document.body.appendChild(temp);
      temp.select();
      document.execCommand("copy");
      document.body.removeChild(temp);
      alert("Copied: " + text);
    }

    // ===== MODAL =====
    function openColorModal(index) {
      selectedColorIndex = index;
      const c = colors[index];
      if (!c) return;

      document.getElementById("modalTitle").textContent = c.name || "Shade details";
      document.getElementById("modalSegment").textContent =
        c.segment === "interior" ? "Interior" :
        c.segment === "exterior" ? "Exterior" :
        c.segment === "ceiling" ? "Ceiling" :
        c.segment === "kids" ? "Kids room" :
        "Other";
      document.getElementById("modalCode").textContent = c.code || c.hex;
      document.getElementById("modalDesc").textContent = c.desc || "No notes added.";
      const swatch = document.getElementById("modalColorSwatch");
      swatch.style.background = c.hex || "#cccccc";

      document.getElementById("modalBackdrop").style.display = "flex";
    }

    function closeColorModal() {
      document.getElementById("modalBackdrop").style.display = "none";
      selectedColorIndex = null;
    }

    // ===== DELETE =====
    function deleteColor(index) {
      if (!confirm("Delete this color permanently?")) return;
      colors.splice(index, 1);
      saveColors();
      renderColors();
      if (selectedColorIndex === index) closeColorModal();
    }

    function deleteImage(index) {
      if (!confirm("Delete this image permanently?")) return;
      images.splice(index, 1);
      saveImages();
      renderImages();
    }

    // ===== NAVIGATION =====
    function setupNav() {
      const navItems = document.querySelectorAll(".nav-item");
      const sections = document.querySelectorAll("[data-section]");

      navItems.forEach(item => {
        item.addEventListener("click", () => {
          navItems.forEach(n => n.classList.remove("active"));
          item.classList.add("active");

          const targetId = item.dataset.target;
          sections.forEach(sec => {
            sec.style.display = sec.id === targetId ? "block" : "none";
          });
        });
      });
    }

    // ===== EVENTS SETUP =====
    function setupFormsAndFilters() {
      // color picker live preview
      const colorHex = document.getElementById("colorHex");
      const previewBox = document.getElementById("colorPreviewBox");
      const previewText = document.getElementById("colorPreviewText");
      colorHex.addEventListener("input", () => {
        previewBox.style.background = colorHex.value;
        previewText.textContent = colorHex.value;
      });

      // save color
      document.getElementById("btnSaveColor").addEventListener("click", () => {
        const name = document.getElementById("colorName").value.trim();
        const code = document.getElementById("colorCode").value.trim();
        const segment = document.getElementById("colorSegment").value;
        const hex = document.getElementById("colorHex").value;
        const desc = document.getElementById("colorDesc").value.trim();

        if (!name) {
          alert("Please enter a color name.");
          return;
        }

        colors.push({ name, code, segment, hex, desc });
        saveColors();
        renderColors();

        document.getElementById("colorName").value = "";
        document.getElementById("colorCode").value = "";
        document.getElementById("colorDesc").value = "";
        alert("Color saved.");
      });

      // filter chips
      document.querySelectorAll(".chip").forEach(chip => {
        chip.addEventListener("click", () => {
          document.querySelectorAll(".chip").forEach(c => c.classList.remove("active"));
          chip.classList.add("active");
          activeFilter = chip.dataset.filter;
          renderColors();
        });
      });

      // search
      document.getElementById("searchColors").addEventListener("input", (e) => {
        searchTerm = e.target.value;
        renderColors();
      });

      // image file preview + save
      const imageFileInput = document.getElementById("imageFile");
      const imagePreviewBox = document.getElementById("imagePreviewBox");

      imageFileInput.addEventListener("change", () => {
        const file = imageFileInput.files[0];
        if (!file) {
          imageDataTemp = null;
          imagePreviewBox.textContent = "No image selected";
          imagePreviewBox.style.background = "#f1f1f1";
          imagePreviewBox.style.color = "#444";
          return;
        }
        const reader = new FileReader();
        reader.onload = (e) => {
          imageDataTemp = e.target.result;
          imagePreviewBox.textContent = "Preview ready";
          imagePreviewBox.style.backgroundImage = "url(" + imageDataTemp + ")";
          imagePreviewBox.style.backgroundSize = "cover";
          imagePreviewBox.style.backgroundPosition = "center";
          imagePreviewBox.style.color = "#ffffff";
        };
        reader.readAsDataURL(file);
      });

      document.getElementById("btnSaveImage").addEventListener("click", () => {
        const title = document.getElementById("imageTitle").value.trim();
        const area = document.getElementById("imageArea").value.trim();
        const desc = document.getElementById("imageDesc").value.trim();
                    const segment = document.getElementById("imageSegment").value;

        if (!imageDataTemp) {
          alert("Please select an image first.");
          return;
        }
                    
            // Collect shades from the shade inputs
            const shades = [];
            const shadeInputs = document.querySelectorAll('#imageShadesContainer .shade-row');
            shadeInputs.forEach(row => {
              const nameInput = row.querySelector('.shade-name');
              const codeInput = row.querySelector('.shade-code');
              if (nameInput && codeInput && nameInput.value.trim()) {
                shades.push({ name: nameInput.value.trim(), code: codeInput.value.trim() });
              }
            });

        images.push({ segment, title, area, desc, shades, data: imageDataTemp });
        saveImages();
        renderImages();

        document.getElementById("imageTitle").value = "";
        document.getElementById("imageArea").value = "";
        document.getElementById("imageDesc").value = "";
        imageFileInput.value = "";
        imageDataTemp = null;
        imagePreviewBox.textContent = "No image selected";
        imagePreviewBox.style.background = "#f1f1f1";
        imagePreviewBox.style.color = "#444";
                    document.getElementById("imageShadesContainer").innerHTML = "";

        alert("Image saved.");
      });

      // modal buttons
      document.getElementById("modalCloseBtn").addEventListener("click", closeColorModal);
      document.getElementById("modalBackdrop").addEventListener("click", (e) => {
        if (e.target.id === "modalBackdrop") closeColorModal();
      });
      document.getElementById("modalCopyBtn").addEventListener("click", () => {
        if (selectedColorIndex == null) return;
        const c = colors[selectedColorIndex];
        copyToClipboard(c.code || c.hex);
      });
      document.getElementById("modalDeleteBtn").addEventListener("click", () => {
        if (selectedColorIndex == null) return;
        deleteColor(selectedColorIndex);
        closeColorModal();
      });
      
            // add shade button
            document.getElementById("btnAddShade").addEventListener("click", () => {
              const container = document.getElementById("imageShadesContainer");
              const row = document.createElement("div");
              row.className = "shade-row";
              row.style.display = "flex";
              row.style.gap = "8px";
              row.style.marginBottom = "8px";
              
              const nameInput = document.createElement("input");
              nameInput.type = "text";
              nameInput.className = "shade-name form-control";
              nameInput.placeholder = "Shade name (e.g. Larry Pin)";
              nameInput.style.flex = "1";
              
              const codeInput = document.createElement("input");
              codeInput.type = "text";
              codeInput.className = "shade-code form-control";
              codeInput.placeholder = "Code (e.g. 2056)";
              codeInput.style.flex = "0.8";
              
              const btnRemove = document.createElement("button");
              btnRemove.type = "button";
              btnRemove.className = "btn-ghost";
              btnRemove.textContent = "‚úï";
              btnRemove.style.padding = "7px 10px";
              btnRemove.addEventListener("click", () => row.remove());
              
              row.appendChild(nameInput);
              row.appendChild(codeInput);
              row.appendChild(btnRemove);
              container.appendChild(row);
            });
    }

    // ===== INIT =====
    document.addEventListener("DOMContentLoaded", () => {
      loadData();  // from localStorage [web:77]
      setupNav();  // sidebar navigation [web:73]
      setupFormsAndFilters();
      renderColors();
      renderImages();
    });
  </script>
</body>
</html>
